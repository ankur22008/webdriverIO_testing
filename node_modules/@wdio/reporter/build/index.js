"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

require("source-map-support/register");

var _fs = _interopRequireDefault(require("fs"));

var _util = require("util");

var _events = _interopRequireDefault(require("events"));

var _suite = _interopRequireDefault(require("./stats/suite"));

var _hook = _interopRequireDefault(require("./stats/hook"));

var _test = _interopRequireDefault(require("./stats/test"));

var _runner = _interopRequireDefault(require("./stats/runner"));

var _constants = require("./constants");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

class WDIOReporter extends _events.default {
  constructor(options) {
    super();
    this.options = options;
    this.outputStream = this.options.stdout ? options.writeStream : _fs.default.createWriteStream(this.options.logFile);
    this.failures = [];
    this.suites = {};
    this.hooks = {};
    this.tests = {};
    this.currentSuites = [];
    this.counts = {
      suites: 0,
      tests: 0,
      hooks: 0,
      passes: 0,
      skipping: 0,
      failures: 0
    };
    let currentTest;
    const rootSuite = new _suite.default({
      title: '(root)',
      fullTitle: '(root)'
    });
    this.currentSuites.push(rootSuite);
    this.on('client:beforeCommand', this.onBeforeCommand.bind(this));
    this.on('client:afterCommand', this.onAfterCommand.bind(this));
    this.on('runner:start',
    /* istanbul ignore next */
    runner => {
      rootSuite.cid = runner.cid;
      this.runnerStat = new _runner.default(runner);
      this.onRunnerStart(this.runnerStat);
    });
    this.on('suite:start',
    /* istanbul ignore next */
    params => {
      const suite = new _suite.default(params);
      const currentSuite = this.currentSuites[this.currentSuites.length - 1];
      currentSuite.suites.push(suite);
      this.currentSuites.push(suite);
      this.suites[suite.uid] = suite;
      this.onSuiteStart(suite);
    });
    this.on('hook:start',
    /* istanbul ignore next */
    hook => {
      const hookStat = new _hook.default(hook);
      const currentSuite = this.currentSuites[this.currentSuites.length - 1];
      currentSuite.hooks.push(hookStat);
      this.hooks[hook.uid] = hookStat;
      this.onHookStart(hookStat);
    });
    this.on('hook:end',
    /* istanbul ignore next */
    hook => {
      const hookStat = this.hooks[hook.uid];
      hookStat.complete(hook.error);
      this.counts.hooks++;
      this.onHookEnd(hookStat);
    });
    this.on('test:start',
    /* istanbul ignore next */
    test => {
      currentTest = new _test.default(test);
      const currentSuite = this.currentSuites[this.currentSuites.length - 1];
      currentSuite.tests.push(currentTest);
      this.tests[test.uid] = currentTest;
      this.onTestStart(currentTest);
    });
    this.on('test:pass',
    /* istanbul ignore next */
    test => {
      const testStat = this.tests[test.uid];
      testStat.pass();
      this.counts.passes++;
      this.counts.tests++;
      this.onTestPass(testStat);
    });
    this.on('test:fail',
    /* istanbul ignore next */
    test => {
      const testStat = this.tests[test.uid];
      /**
       * replace "Ensure the done() callback is being called in this test." with more meaningful
       * message (Mocha only)
       */

      if (test.error && test.error.message && test.error.message.includes(_constants.MOCHA_TIMEOUT_MESSAGE)) {
        let replacement = (0, _util.format)(_constants.MOCHA_TIMEOUT_MESSAGE_REPLACEMENT, test.parent, test.title);
        test.error.message = test.error.message.replace(_constants.MOCHA_TIMEOUT_MESSAGE, replacement);
        test.error.stack = test.error.stack.replace(_constants.MOCHA_TIMEOUT_MESSAGE, replacement);
      }

      testStat.fail(test.error);
      this.counts.failures++;
      this.counts.tests++;
      this.onTestFail(testStat);
    });
    this.on('test:pending',
    /* istanbul ignore next */
    test => {
      const currentSuite = this.currentSuites[this.currentSuites.length - 1];
      currentTest = new _test.default(test);
      /**
       * In Mocha: tests that are skipped don't have a start event but a test end.
       * In Jasmine: tests have a start event, therefor we need to replace the
       * test instance with the pending test here
       */

      const suiteTests = currentSuite.tests;

      if (!suiteTests.length || currentTest.uid !== suiteTests[suiteTests.length - 1].uid) {
        currentSuite.tests.push(currentTest);
      } else {
        suiteTests[suiteTests.length - 1] = currentTest;
      }

      this.tests[test.uid] = currentTest;
      currentTest.skip();
      this.counts.skipping++;
      this.counts.tests++;
      this.onTestSkip(currentTest);
    });
    this.on('test:end',
    /* istanbul ignore next */
    test => {
      const testStat = this.tests[test.uid];
      this.onTestEnd(testStat);
    });
    this.on('suite:end',
    /* istanbul ignore next */
    suite => {
      const suiteStat = this.suites[suite.uid];
      suiteStat.complete();
      this.currentSuites.pop();
      this.onSuiteEnd(suiteStat);
    });
    this.on('runner:end',
    /* istanbul ignore next */
    runner => {
      rootSuite.complete();
      this.runnerStat.failures = runner.failures;
      this.runnerStat.complete();
      this.onRunnerEnd(this.runnerStat);
    });
    /**
     * browser client event handlers
     */

    this.on('client:command',
    /* istanbul ignore next */
    payload => {
      if (!currentTest) {
        return;
      }

      currentTest.output.push(Object.assign(payload, {
        type: 'command'
      }));
    });
    this.on('client:result',
    /* istanbul ignore next */
    payload => {
      if (!currentTest) {
        return;
      }

      currentTest.output.push(Object.assign(payload, {
        type: 'result'
      }));
    });
  }
  /**
   * allows reporter to stale process shutdown process until required sync work
   * is done (e.g. when having to send data to some server or any other async work)
   */


  get isSynchronised() {
    return true;
  }
  /**
   * function to write to reporters output stream
   */


  write(content) {
    this.outputStream.write(content);
  }
  /* istanbul ignore next */


  onRunnerStart() {}
  /* istanbul ignore next */


  onBeforeCommand() {}
  /* istanbul ignore next */


  onAfterCommand() {}
  /* istanbul ignore next */


  onScreenshot() {}
  /* istanbul ignore next */


  onSuiteStart() {}
  /* istanbul ignore next */


  onHookStart() {}
  /* istanbul ignore next */


  onHookEnd() {}
  /* istanbul ignore next */


  onTestStart() {}
  /* istanbul ignore next */


  onTestPass() {}
  /* istanbul ignore next */


  onTestFail() {}
  /* istanbul ignore next */


  onTestSkip() {}
  /* istanbul ignore next */


  onTestEnd() {}
  /* istanbul ignore next */


  onSuiteEnd() {}
  /* istanbul ignore next */


  onRunnerEnd() {}

}

exports.default = WDIOReporter;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9pbmRleC5qcyJdLCJuYW1lcyI6WyJXRElPUmVwb3J0ZXIiLCJFdmVudEVtaXR0ZXIiLCJjb25zdHJ1Y3RvciIsIm9wdGlvbnMiLCJvdXRwdXRTdHJlYW0iLCJzdGRvdXQiLCJ3cml0ZVN0cmVhbSIsImZzIiwiY3JlYXRlV3JpdGVTdHJlYW0iLCJsb2dGaWxlIiwiZmFpbHVyZXMiLCJzdWl0ZXMiLCJob29rcyIsInRlc3RzIiwiY3VycmVudFN1aXRlcyIsImNvdW50cyIsInBhc3NlcyIsInNraXBwaW5nIiwiY3VycmVudFRlc3QiLCJyb290U3VpdGUiLCJTdWl0ZVN0YXRzIiwidGl0bGUiLCJmdWxsVGl0bGUiLCJwdXNoIiwib24iLCJvbkJlZm9yZUNvbW1hbmQiLCJvbkFmdGVyQ29tbWFuZCIsInJ1bm5lciIsImNpZCIsInJ1bm5lclN0YXQiLCJSdW5uZXJTdGF0cyIsIm9uUnVubmVyU3RhcnQiLCJwYXJhbXMiLCJzdWl0ZSIsImN1cnJlbnRTdWl0ZSIsImxlbmd0aCIsInVpZCIsIm9uU3VpdGVTdGFydCIsImhvb2siLCJob29rU3RhdCIsIkhvb2tTdGF0cyIsIm9uSG9va1N0YXJ0IiwiY29tcGxldGUiLCJlcnJvciIsIm9uSG9va0VuZCIsInRlc3QiLCJUZXN0U3RhdHMiLCJvblRlc3RTdGFydCIsInRlc3RTdGF0IiwicGFzcyIsIm9uVGVzdFBhc3MiLCJtZXNzYWdlIiwiaW5jbHVkZXMiLCJNT0NIQV9USU1FT1VUX01FU1NBR0UiLCJyZXBsYWNlbWVudCIsIk1PQ0hBX1RJTUVPVVRfTUVTU0FHRV9SRVBMQUNFTUVOVCIsInBhcmVudCIsInJlcGxhY2UiLCJzdGFjayIsImZhaWwiLCJvblRlc3RGYWlsIiwic3VpdGVUZXN0cyIsInNraXAiLCJvblRlc3RTa2lwIiwib25UZXN0RW5kIiwic3VpdGVTdGF0IiwicG9wIiwib25TdWl0ZUVuZCIsIm9uUnVubmVyRW5kIiwicGF5bG9hZCIsIm91dHB1dCIsIk9iamVjdCIsImFzc2lnbiIsInR5cGUi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RUFBQUEsZUFBZSxHQUFJLENBQUU7QUFDckI7OztBQUNBQyxFQUFBQSxjQUFjLEdBQUksQ0FBRTtBQUNwQjs7O0FBQ0FtRCxFQUFBQSxZQUFZLEdBQUksQ0FBRTtBQUNsQjs7O0FBQ0F4QyxFQUFBQSxZQUFZLEdBQUksQ0FBRTtBQUNsQjs7O0FBQ0FJLEVBQUFBLFdBQVcsR0FBSSxDQUFFO0FBQ2pCOzs7QUFDQUcsRUFBQUEsU0FBUyxHQUFJLENBQUU7QUFDZjs7O0FBQ0FHLEVBQUFBLFdBQVcsR0FBSSxDQUFFO0FBQ2pCOzs7QUFDQUcsRUFBQUEsVUFBVSxHQUFJLENBQUU7QUFDaEI7OztBQUNBVSxFQUFBQSxVQUFVLEdBQUksQ0FBRTtBQUNoQjs7O0FBQ0FHLEVBQUFBLFVBQVUsR0FBSSxDQUFFO0FBQ2hCOzs7QUFDQUMsRUFBQUEsU0FBUyxHQUFJLENBQUU7QUFDZjs7O0FBQ0FHLEVBQUFBLFVBQVUsR0FBSSxDQUFFO0FBQ2hCOzs7QUFDQUMsRUFBQUEsV0FBVyxHQUFJLENBQUU7O0FBcE1rQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBmcyBmcm9tICdmcydcbmltcG9ydCB7IGZvcm1hdCB9IGZyb20gJ3V0aWwnXG5pbXBvcnQgRXZlbnRFbWl0dGVyIGZyb20gJ2V2ZW50cydcblxuaW1wb3J0IFN1aXRlU3RhdHMgZnJvbSAnLi9zdGF0cy9zdWl0ZSdcbmltcG9ydCBIb29rU3RhdHMgZnJvbSAnLi9zdGF0cy9ob29rJ1xuaW1wb3J0IFRlc3RTdGF0cyBmcm9tICcuL3N0YXRzL3Rlc3QnXG5cbmltcG9ydCBSdW5uZXJTdGF0cyBmcm9tICcuL3N0YXRzL3J1bm5lcidcblxuaW1wb3J0IHsgTU9DSEFfVElNRU9VVF9NRVNTQUdFLCBNT0NIQV9USU1FT1VUX01FU1NBR0VfUkVQTEFDRU1FTlQgfSBmcm9tICcuL2NvbnN0YW50cydcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgV0RJT1JlcG9ydGVyIGV4dGVuZHMgRXZlbnRFbWl0dGVyIHtcbiAgICBjb25zdHJ1Y3RvciAob3B0aW9ucykge1xuICAgICAgICBzdXBlcigpXG4gICAgICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnNcbiAgICAgICAgdGhpcy5vdXRwdXRTdHJlYW0gPSB0aGlzLm9wdGlvbnMuc3Rkb3V0ID8gb3B0aW9ucy53cml0ZVN0cmVhbSA6IGZzLmNyZWF0ZVdyaXRlU3RyZWFtKHRoaXMub3B0aW9ucy5sb2dGaWxlKVxuICAgICAgICB0aGlzLmZhaWx1cmVzID0gW11cbiAgICAgICAgdGhpcy5zdWl0ZXMgPSB7fVxuICAgICAgICB0aGlzLmhvb2tzID0ge31cbiAgICAgICAgdGhpcy50ZXN0cyA9IHt9XG4gICAgICAgIHRoaXMuY3VycmVudFN1aXRlcyA9IFtdXG4gICAgICAgIHRoaXMuY291bnRzID0ge1xuICAgICAgICAgICAgc3VpdGVzOiAwLFxuICAgICAgICAgICAgdGVzdHM6IDAsXG4gICAgICAgICAgICBob29rczogMCxcbiAgICAgICAgICAgIHBhc3NlczogMCxcbiAgICAgICAgICAgIHNraXBwaW5nOiAwLFxuICAgICAgICAgICAgZmFpbHVyZXM6IDBcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBjdXJyZW50VGVzdFxuXG4gICAgICAgIGNvbnN0IHJvb3RTdWl0ZSA9IG5ldyBTdWl0ZVN0YXRzKHtcbiAgICAgICAgICAgIHRpdGxlOiAnKHJvb3QpJyxcbiAgICAgICAgICAgIGZ1bGxUaXRsZTogJyhyb290KScsXG4gICAgICAgIH0pXG4gICAgICAgIHRoaXMuY3VycmVudFN1aXRlcy5wdXNoKHJvb3RTdWl0ZSlcblxuICAgICAgICB0aGlzLm9uKCdjbGllbnQ6YmVmb3JlQ29tbWFuZCcsIDo6dGhpcy5vbkJlZm9yZUNvbW1hbmQpXG4gICAgICAgIHRoaXMub24oJ2NsaWVudDphZnRlckNvbW1hbmQnLCA6OnRoaXMub25BZnRlckNvbW1hbmQpXG5cbiAgICAgICAgdGhpcy5vbigncnVubmVyOnN0YXJ0JywgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovIChydW5uZXIpID0+IHtcbiAgICAgICAgICAgIHJvb3RTdWl0ZS5jaWQgPSBydW5uZXIuY2lkXG4gICAgICAgICAgICB0aGlzLnJ1bm5lclN0YXQgPSBuZXcgUnVubmVyU3RhdHMocnVubmVyKVxuICAgICAgICAgICAgdGhpcy5vblJ1bm5lclN0YXJ0KHRoaXMucnVubmVyU3RhdClcbiAgICAgICAgfSlcblxuICAgICAgICB0aGlzLm9uKCdzdWl0ZTpzdGFydCcsICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLyAocGFyYW1zKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzdWl0ZSA9IG5ldyBTdWl0ZVN0YXRzKHBhcmFtcylcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRTdWl0ZSA9IHRoaXMuY3VycmVudFN1aXRlc1t0aGlzLmN1cnJlbnRTdWl0ZXMubGVuZ3RoIC0gMV1cbiAgICAgICAgICAgIGN1cnJlbnRTdWl0ZS5zdWl0ZXMucHVzaChzdWl0ZSlcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFN1aXRlcy5wdXNoKHN1aXRlKVxuICAgICAgICAgICAgdGhpcy5zdWl0ZXNbc3VpdGUudWlkXSA9IHN1aXRlXG4gICAgICAgICAgICB0aGlzLm9uU3VpdGVTdGFydChzdWl0ZSlcbiAgICAgICAgfSlcblxuICAgICAgICB0aGlzLm9uKCdob29rOnN0YXJ0JywgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovIChob29rKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBob29rU3RhdCA9IG5ldyBIb29rU3RhdHMoaG9vaylcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRTdWl0ZSA9IHRoaXMuY3VycmVudFN1aXRlc1t0aGlzLmN1cnJlbnRTdWl0ZXMubGVuZ3RoIC0gMV1cbiAgICAgICAgICAgIGN1cnJlbnRTdWl0ZS5ob29rcy5wdXNoKGhvb2tTdGF0KVxuICAgICAgICAgICAgdGhpcy5ob29rc1tob29rLnVpZF0gPSBob29rU3RhdFxuICAgICAgICAgICAgdGhpcy5vbkhvb2tTdGFydChob29rU3RhdClcbiAgICAgICAgfSlcblxuICAgICAgICB0aGlzLm9uKCdob29rOmVuZCcsICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLyAoaG9vaykgPT4ge1xuICAgICAgICAgICAgY29uc3QgaG9va1N0YXQgPSB0aGlzLmhvb2tzW2hvb2sudWlkXVxuICAgICAgICAgICAgaG9va1N0YXQuY29tcGxldGUoaG9vay5lcnJvcilcbiAgICAgICAgICAgIHRoaXMuY291bnRzLmhvb2tzKytcbiAgICAgICAgICAgIHRoaXMub25Ib29rRW5kKGhvb2tTdGF0KVxuICAgICAgICB9KVxuXG4gICAgICAgIHRoaXMub24oJ3Rlc3Q6c3RhcnQnLCAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi8gKHRlc3QpID0+IHtcbiAgICAgICAgICAgIGN1cnJlbnRUZXN0ID0gbmV3IFRlc3RTdGF0cyh0ZXN0KVxuICAgICAgICAgICAgY29uc3QgY3VycmVudFN1aXRlID0gdGhpcy5jdXJyZW50U3VpdGVzW3RoaXMuY3VycmVudFN1aXRlcy5sZW5ndGggLSAxXVxuICAgICAgICAgICAgY3VycmVudFN1aXRlLnRlc3RzLnB1c2goY3VycmVudFRlc3QpXG4gICAgICAgICAgICB0aGlzLnRlc3RzW3Rlc3QudWlkXSA9IGN1cnJlbnRUZXN0XG4gICAgICAgICAgICB0aGlzLm9uVGVzdFN0YXJ0KGN1cnJlbnRUZXN0KVxuICAgICAgICB9KVxuXG4gICAgICAgIHRoaXMub24oJ3Rlc3Q6cGFzcycsICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLyAodGVzdCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgdGVzdFN0YXQgPSB0aGlzLnRlc3RzW3Rlc3QudWlkXVxuICAgICAgICAgICAgdGVzdFN0YXQucGFzcygpXG4gICAgICAgICAgICB0aGlzLmNvdW50cy5wYXNzZXMrK1xuICAgICAgICAgICAgdGhpcy5jb3VudHMudGVzdHMrK1xuICAgICAgICAgICAgdGhpcy5vblRlc3RQYXNzKHRlc3RTdGF0KVxuICAgICAgICB9KVxuXG4gICAgICAgIHRoaXMub24oJ3Rlc3Q6ZmFpbCcsICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLyAodGVzdCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgdGVzdFN0YXQgPSB0aGlzLnRlc3RzW3Rlc3QudWlkXVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIHJlcGxhY2UgXCJFbnN1cmUgdGhlIGRvbmUoKSBjYWxsYmFjayBpcyBiZWluZyBjYWxsZWQgaW4gdGhpcyB0ZXN0LlwiIHdpdGggbW9yZSBtZWFuaW5nZnVsXG4gICAgICAgICAgICAgKiBtZXNzYWdlIChNb2NoYSBvbmx5KVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpZiAodGVzdC5lcnJvciAmJiB0ZXN0LmVycm9yLm1lc3NhZ2UgJiYgdGVzdC5lcnJvci5tZXNzYWdlLmluY2x1ZGVzKE1PQ0hBX1RJTUVPVVRfTUVTU0FHRSkpIHtcbiAgICAgICAgICAgICAgICBsZXQgcmVwbGFjZW1lbnQgPSBmb3JtYXQoTU9DSEFfVElNRU9VVF9NRVNTQUdFX1JFUExBQ0VNRU5ULCB0ZXN0LnBhcmVudCwgdGVzdC50aXRsZSlcbiAgICAgICAgICAgICAgICB0ZXN0LmVycm9yLm1lc3NhZ2UgPSB0ZXN0LmVycm9yLm1lc3NhZ2UucmVwbGFjZShNT0NIQV9USU1FT1VUX01FU1NBR0UsIHJlcGxhY2VtZW50KVxuICAgICAgICAgICAgICAgIHRlc3QuZXJyb3Iuc3RhY2sgPSB0ZXN0LmVycm9yLnN0YWNrLnJlcGxhY2UoTU9DSEFfVElNRU9VVF9NRVNTQUdFLCByZXBsYWNlbWVudClcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGVzdFN0YXQuZmFpbCh0ZXN0LmVycm9yKVxuICAgICAgICAgICAgdGhpcy5jb3VudHMuZmFpbHVyZXMrK1xuICAgICAgICAgICAgdGhpcy5jb3VudHMudGVzdHMrK1xuICAgICAgICAgICAgdGhpcy5vblRlc3RGYWlsKHRlc3RTdGF0KVxuICAgICAgICB9KVxuXG4gICAgICAgIHRoaXMub24oJ3Rlc3Q6cGVuZGluZycsICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLyAodGVzdCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgY3VycmVudFN1aXRlID0gdGhpcy5jdXJyZW50U3VpdGVzW3RoaXMuY3VycmVudFN1aXRlcy5sZW5ndGggLSAxXVxuICAgICAgICAgICAgY3VycmVudFRlc3QgPSBuZXcgVGVzdFN0YXRzKHRlc3QpXG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogSW4gTW9jaGE6IHRlc3RzIHRoYXQgYXJlIHNraXBwZWQgZG9uJ3QgaGF2ZSBhIHN0YXJ0IGV2ZW50IGJ1dCBhIHRlc3QgZW5kLlxuICAgICAgICAgICAgICogSW4gSmFzbWluZTogdGVzdHMgaGF2ZSBhIHN0YXJ0IGV2ZW50LCB0aGVyZWZvciB3ZSBuZWVkIHRvIHJlcGxhY2UgdGhlXG4gICAgICAgICAgICAgKiB0ZXN0IGluc3RhbmNlIHdpdGggdGhlIHBlbmRpbmcgdGVzdCBoZXJlXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGNvbnN0IHN1aXRlVGVzdHMgPSBjdXJyZW50U3VpdGUudGVzdHNcbiAgICAgICAgICAgIGlmICghc3VpdGVUZXN0cy5sZW5ndGggfHwgY3VycmVudFRlc3QudWlkICE9PSBzdWl0ZVRlc3RzW3N1aXRlVGVzdHMubGVuZ3RoIC0gMV0udWlkKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudFN1aXRlLnRlc3RzLnB1c2goY3VycmVudFRlc3QpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHN1aXRlVGVzdHNbc3VpdGVUZXN0cy5sZW5ndGggLSAxXSA9IGN1cnJlbnRUZXN0XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMudGVzdHNbdGVzdC51aWRdID0gY3VycmVudFRlc3RcbiAgICAgICAgICAgIGN1cnJlbnRUZXN0LnNraXAoKVxuICAgICAgICAgICAgdGhpcy5jb3VudHMuc2tpcHBpbmcrK1xuICAgICAgICAgICAgdGhpcy5jb3VudHMudGVzdHMrK1xuICAgICAgICAgICAgdGhpcy5vblRlc3RTa2lwKGN1cnJlbnRUZXN0KVxuICAgICAgICB9KVxuXG4gICAgICAgIHRoaXMub24oJ3Rlc3Q6ZW5kJywgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovICh0ZXN0KSA9PiB7XG4gICAgICAgICAgICBjb25zdCB0ZXN0U3RhdCA9IHRoaXMudGVzdHNbdGVzdC51aWRdXG4gICAgICAgICAgICB0aGlzLm9uVGVzdEVuZCh0ZXN0U3RhdClcbiAgICAgICAgfSlcblxuICAgICAgICB0aGlzLm9uKCdzdWl0ZTplbmQnLCAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi8gKHN1aXRlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzdWl0ZVN0YXQgPSB0aGlzLnN1aXRlc1tzdWl0ZS51aWRdXG4gICAgICAgICAgICBzdWl0ZVN0YXQuY29tcGxldGUoKVxuICAgICAgICAgICAgdGhpcy5jdXJyZW50U3VpdGVzLnBvcCgpXG4gICAgICAgICAgICB0aGlzLm9uU3VpdGVFbmQoc3VpdGVTdGF0KVxuICAgICAgICB9KVxuXG4gICAgICAgIHRoaXMub24oJ3J1bm5lcjplbmQnLCAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi8gKHJ1bm5lcikgPT4ge1xuICAgICAgICAgICAgcm9vdFN1aXRlLmNvbXBsZXRlKClcbiAgICAgICAgICAgIHRoaXMucnVubmVyU3RhdC5mYWlsdXJlcyA9IHJ1bm5lci5mYWlsdXJlc1xuICAgICAgICAgICAgdGhpcy5ydW5uZXJTdGF0LmNvbXBsZXRlKClcbiAgICAgICAgICAgIHRoaXMub25SdW5uZXJFbmQodGhpcy5ydW5uZXJTdGF0KVxuICAgICAgICB9KVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBicm93c2VyIGNsaWVudCBldmVudCBoYW5kbGVyc1xuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5vbignY2xpZW50OmNvbW1hbmQnLCAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi8gKHBheWxvYWQpID0+IHtcbiAgICAgICAgICAgIGlmICghY3VycmVudFRlc3QpIHtcbiAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGN1cnJlbnRUZXN0Lm91dHB1dC5wdXNoKE9iamVjdC5hc3NpZ24ocGF5bG9hZCwgeyB0eXBlOiAnY29tbWFuZCcgfSkpXG4gICAgICAgIH0pXG4gICAgICAgIHRoaXMub24oJ2NsaWVudDpyZXN1bHQnLCAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi8gKHBheWxvYWQpID0+IHtcbiAgICAgICAgICAgIGlmICghY3VycmVudFRlc3QpIHtcbiAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGN1cnJlbnRUZXN0Lm91dHB1dC5wdXNoKE9iamVjdC5hc3NpZ24ocGF5bG9hZCwgeyB0eXBlOiAncmVzdWx0JyB9KSlcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBhbGxvd3MgcmVwb3J0ZXIgdG8gc3RhbGUgcHJvY2VzcyBzaHV0ZG93biBwcm9jZXNzIHVudGlsIHJlcXVpcmVkIHN5bmMgd29ya1xuICAgICAqIGlzIGRvbmUgKGUuZy4gd2hlbiBoYXZpbmcgdG8gc2VuZCBkYXRhIHRvIHNvbWUgc2VydmVyIG9yIGFueSBvdGhlciBhc3luYyB3b3JrKVxuICAgICAqL1xuICAgIGdldCBpc1N5bmNocm9uaXNlZCAoKSB7XG4gICAgICAgIHJldHVybiB0cnVlXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogZnVuY3Rpb24gdG8gd3JpdGUgdG8gcmVwb3J0ZXJzIG91dHB1dCBzdHJlYW1cbiAgICAgKi9cbiAgICB3cml0ZSAoY29udGVudCkge1xuICAgICAgICB0aGlzLm91dHB1dFN0cmVhbS53cml0ZShjb250ZW50KVxuICAgIH1cblxuICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG4gICAgb25SdW5uZXJTdGFydCAoKSB7fVxuICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG4gICAgb25CZWZvcmVDb21tYW5kICgpIHt9XG4gICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbiAgICBvbkFmdGVyQ29tbWFuZCAoKSB7fVxuICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG4gICAgb25TY3JlZW5zaG90ICgpIHt9XG4gICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbiAgICBvblN1aXRlU3RhcnQgKCkge31cbiAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xuICAgIG9uSG9va1N0YXJ0ICgpIHt9XG4gICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbiAgICBvbkhvb2tFbmQgKCkge31cbiAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xuICAgIG9uVGVzdFN0YXJ0ICgpIHt9XG4gICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbiAgICBvblRlc3RQYXNzICgpIHt9XG4gICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbiAgICBvblRlc3RGYWlsICgpIHt9XG4gICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbiAgICBvblRlc3RTa2lwICgpIHt9XG4gICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbiAgICBvblRlc3RFbmQgKCkge31cbiAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xuICAgIG9uU3VpdGVFbmQgKCkge31cbiAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xuICAgIG9uUnVubmVyRW5kICgpIHt9XG59XG4iXX0=